module.exports=[69856,a=>{"use strict";var b=a.i(37936),c=a.i(77607),d=a.i(95562),e=a.i(13095);let f=async()=>{await (0,c.signOut)({redirectTo:d.default.unAuthenticatedEntryPath})};(0,e.ensureServerEntryExports)([f]),(0,b.registerServerReference)(f,"0044e7f0bb2859832d1c4d0d422bd8cfafad8fcd7f",null),a.s(["default",0,f])},81212,a=>{"use strict";var b=a.i(37936),c=a.i(48734);async function d(){let a=await (0,c.query)("SELECT * FROM settings"),b={};return a.forEach(a=>{b[a.key]=a.value}),b}async function e(a){let b=await (0,c.queryFirst)("SELECT * FROM settings WHERE key = ?",[a]);return b?.value||""}async function f(a,b){await (0,c.execute)("INSERT OR REPLACE INTO settings (key, value, updated_at) VALUES (?, ?, ?)",[a,b,(0,c.nowWIB)()])}async function g(a){for(let[b,c]of Object.entries(a))await f(b,c)}async function h(a){return a?(0,c.query)("SELECT * FROM categories WHERE type = ? ORDER BY name",[a]):(0,c.query)("SELECT * FROM categories ORDER BY type, name")}async function i(){return h("campaign")}async function j(){return h("news")}(0,a.i(13095).ensureServerEntryExports)([d,e,f,g,h,i,j]),(0,b.registerServerReference)(d,"00ce9b7d34a5ff7cf5d8f3e3e4cce97b13aa2defdd",null),(0,b.registerServerReference)(e,"40fe6bd0117ce571d8ca685e3223ecf23d03b5a3f1",null),(0,b.registerServerReference)(f,"60084b96606dbd2b4d1dfed67998503e15731cd9ba",null),(0,b.registerServerReference)(g,"40cc5dc7c0f41860707e2133c7300c9397445c151d",null),(0,b.registerServerReference)(h,"40f728ce678adde562766b833a1db6dcfd43f948a9",null),(0,b.registerServerReference)(i,"00df93a0ae317fef9e8935bba0a0cd94f2184bcfd7",null),(0,b.registerServerReference)(j,"005bd03ddbce436349c0ff8debfe51d321cf52c9e1",null),a.s(["getCampaignCategories",()=>i,"getNewsCategories",()=>j,"getSettings",()=>d,"updateSettings",()=>g])},24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},88948,a=>{"use strict";var b=a.i(37936);async function c(b){let c=b.get("file");if(!c)throw Error("No file provided");let d=await c.arrayBuffer(),e=Buffer.from(d),f=c.name.split(".").pop()||"png",g=`${Date.now()}-${Math.random().toString(36).slice(2,8)}.${f}`;if("u"<typeof process||globalThis.__cf_env__){try{let a=globalThis.__cf_env__;if(a?.STORAGE)return await a.STORAGE.put(`uploads/${g}`,e,{httpMetadata:{contentType:c.type}}),{url:`/uploads/${g}`}}catch(a){console.error("R2 upload error:",a)}let a=e.toString("base64");return{url:`data:${c.type};base64,${a}`}}{let b=a.r(24868),c=a.r(14747),d=c.join(process.cwd(),"public","uploads");return await b.mkdir(d,{recursive:!0}),await b.writeFile(c.join(d,g),e),{url:`/uploads/${g}`}}}(0,a.i(13095).ensureServerEntryExports)([c]),(0,b.registerServerReference)(c,"40df2b0c12396596b4e6cc85e14bd942bf6ea2e544",null),a.s(["uploadImage",()=>c])},78288,a=>{"use strict";var b=a.i(37936),c=a.i(48734);async function d(a){let b=`
        SELECT n.*, cat.name as category_name, u.name as author_name
        FROM news n
        LEFT JOIN categories cat ON n.category_id = cat.id
        LEFT JOIN users u ON n.author_id = u.id
    `,d=[];return a&&"all"!==a&&(b+=" WHERE n.status = ?",d.push(a)),b+=" ORDER BY n.created_at DESC",(0,c.query)(b,d)}async function e(a){return(0,c.queryFirst)(`SELECT n.*, cat.name as category_name, u.name as author_name
         FROM news n
         LEFT JOIN categories cat ON n.category_id = cat.id
         LEFT JOIN users u ON n.author_id = u.id
         WHERE n.id = ?`,[a])}async function f(a){let b=`
        SELECT n.*, cat.name as category_name, u.name as author_name
        FROM news n
        LEFT JOIN categories cat ON n.category_id = cat.id
        LEFT JOIN users u ON n.author_id = u.id
        WHERE n.status = 'published'
        ORDER BY n.published_at DESC
    `;return a&&(b+=` LIMIT ${a}`),(0,c.query)(b)}async function g(a,b="admin-001"){let d=(0,c.generateId)(),e=(0,c.slugify)(a.title)+"-"+Date.now().toString(36),f=a.status||"draft",h="published"===f?(0,c.nowWIB)():null;try{await (0,c.execute)(`INSERT INTO news (id, title, slug, excerpt, content, image, category_id, author_id, status, published_at, created_at)
             VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[d,a.title,e,a.excerpt||"",a.content||"",a.image||"",a.category_id||null,b,f,h,(0,c.nowWIB)()])}catch(a){throw console.error("createNews error:",a),Error("Gagal menyimpan berita: "+(a?.message||"Unknown error"))}return{id:d,slug:e}}async function h(a,b){let d=[],e=[];void 0!==b.title&&(d.push("title = ?"),e.push(b.title)),void 0!==b.excerpt&&(d.push("excerpt = ?"),e.push(b.excerpt)),void 0!==b.content&&(d.push("content = ?"),e.push(b.content)),void 0!==b.image&&(d.push("image = ?"),e.push(b.image)),void 0!==b.category_id&&(d.push("category_id = ?"),e.push(b.category_id)),void 0!==b.status&&(d.push("status = ?"),e.push(b.status),"published"===b.status&&(d.push("published_at = ?"),e.push((0,c.nowWIB)()))),d.push("updated_at = ?"),e.push((0,c.nowWIB)()),e.push(a),await (0,c.execute)(`UPDATE news SET ${d.join(", ")} WHERE id = ?`,e)}async function i(a){await (0,c.execute)("DELETE FROM news WHERE id = ?",[a])}(0,a.i(13095).ensureServerEntryExports)([d,e,f,g,h,i]),(0,b.registerServerReference)(d,"40acfd779b2a0c8a4f1db6e209b4fecdeabc1e2a64",null),(0,b.registerServerReference)(e,"400dce6d2e7c46bf11b619874d570298c948ecdef9",null),(0,b.registerServerReference)(f,"401030b8607080037b44a144d3ae7d681b386c1fd9",null),(0,b.registerServerReference)(g,"60bfcfae2a0bec125b016bffacc97c61cae0879fcf",null),(0,b.registerServerReference)(h,"6030269e6d6c2999056a1b6897da59aa0627edefa2",null),(0,b.registerServerReference)(i,"409a4fbf651c8255416b3c7a3f26bc1167e331ec69",null),a.s(["createNews",()=>g,"deleteNews",()=>i,"getNews",()=>d,"getNewsById",()=>e,"getPublishedNews",()=>f,"updateNews",()=>h])},3827,a=>{"use strict";var b=a.i(39624),c=a.i(25737),d=a.i(69856),e=a.i(88948),f=a.i(78288),g=a.i(81212);a.s([],79840),a.i(79840),a.s(["0044e7f0bb2859832d1c4d0d422bd8cfafad8fcd7f",()=>d.default,"005bd03ddbce436349c0ff8debfe51d321cf52c9e1",()=>g.getNewsCategories,"00cf2a8738ddd41ad6903161d87efa51e887637153",()=>c.getTheme,"400dce6d2e7c46bf11b619874d570298c948ecdef9",()=>f.getNewsById,"40745ded225c07a0af4ec4245c71c88dec53a174cf",()=>c.setTheme,"40ccd30b3cc6655717bc8b6776451d6ff35c8e08bd",()=>b.default,"40df2b0c12396596b4e6cc85e14bd942bf6ea2e544",()=>e.uploadImage,"6030269e6d6c2999056a1b6897da59aa0627edefa2",()=>f.updateNews,"60bfcfae2a0bec125b016bffacc97c61cae0879fcf",()=>f.createNews],3827)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d8605e2a._.js.map